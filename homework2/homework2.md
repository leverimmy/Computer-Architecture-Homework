# 第 2 次作业

## 第 1 题（教材 7.8）

> 假设对指令 Cache 的访问占全部访问的 $75\%$；而对数据 Cache 的访问占全部访问的 $25\%$。Cache 的命中时间为一个时钟周期，不命中开销为 $50$ 个时钟周期，在混合 Cache 中一次 `load` 或 `store` 操作访问 Cache 的命中时间都要增加一个时钟周期，$32\;\mathrm{KB}$ 的指令 Cache 的不命中率为 $0.39\%$，$32\;\mathrm{KB}$ 的数据 Cache 的不命中率为 $4.82\%$，$64\;\mathrm{KB}$ 的混合 Cache 的不命中率为 $1.35\%$。又假设采用写直达策略，且有一个写缓冲器，并且忽略写缓冲器引起的等待。试问指令 Cache 和数据 Cache 容量均为 $32\;\mathrm{KB}$ 的分离 Cache 和容量为 $64\;\mathrm{KB}$ 的混合 Cache 相比，哪种 Cache 的不命中率更低？两种情况下平均访存时间各是多少？

## 第 2 题（教材 7.11）

> 在伪相联中，假设在直接映像位置没有发现匹配，而在另一个位置才找到数据（伪命中）时，不对这两个位置的数据进行交换。这时只需要一个额外的周期。假设不命中开销为 $50$ 个时钟周期，$2\;\mathrm{KB}$ 直接映像 Cache 的不命中率为 $9.8\%$，两路组相联的不命中率为 $7.6\%$；$128\;\mathrm{KB}$ 直接映像 Cache 的不命中率为 $1.0\%$，两路组相联的不命中率为 $0.7\%$。
>
> (1) 推导出平均访存时间的公式。
>
> (2) 利用 (1) 中得到的公式，对于 $2\;\mathrm{KB}$ Cache 和 $128\;\mathrm{KB}$ Cache，计算伪相联的平均访存时间。

## 第 3 题（教材 7.12）

> 假设采用理想存储器系统时的基本 CPI 是 $1.5$，主存延迟是 $40$ 个时钟周期；传输速率为 $4$ 字节/时钟周期，且 Cache 中 $50\%$ 的块是修改过的。每个块中有 $32$ 字节，$20\%$ 的指令是数据传送指令，并假设没有写缓存，在 TLB 不命中的情况下需要 $20$ 个时钟周期，TLB 不会降低 Cache 命中率。CPU 产生指令地址或 Cache 不命中时产生的地址有 $0.2\%$ 没有在 TLB 中找到。
>
> (1) 在理想 TLB 情况下，计算均采用写回法 $16\;\mathrm{KB}$ 直接映像混合 Cache、$16\;\mathrm{KB}$ 两路组相联混合 Cache 和 $32\;\mathrm{KB}$ 直接映像混合 Cache 机器的实际 CPI。
>
> (2) 在实际 TLB 情况下，用 (1) 的结果，计算均采用写回法 $16\;\mathrm{KB}$ 直接映像混合 Cache、$16\;\mathrm{KB}$ 两路组相联混合 Cache 和 $32\;\mathrm{KB}$ 直接映像混合 Cache 机器的实际 CPI。
>
> 其中假设 $16\;\mathrm{KB}$ 直接映像混合 Cache、$16\;\mathrm{KB}$ 两路组相联混合 Cache 和 $32\;\mathrm{KB}$ 直接映像混合 Cache 的不命中率分别为 $2.9\%$、$2.2\%$ 和 $2.0\%$；$25\%$ 的访存为写访问。

## 第 4 题（教材 7.13）

> 某个程序共访问存储器 $1\;000\;000$ 次，该程序在某个系统中运行，系统中 Cache 的不命中率为 $7\%$，其中，强制性不命中和容量不命中各占 $25\%$，冲突不命中占 $50\%$。问：
>
> (1) 当允许对该 Cache 所做的唯一改变是提高相联度时，此时期望能够消除的最大不
命中次数是多少？
>
> (2) 当允许能够同时提高 Cache 的容量大小和相联度时，此时期望能够消除的最大不命中次数是多少？

## 第 5 题（教材 7.16）

> 设主存由 $8$ 个存储体按低位交叉编址方式组成，主存容量 $1\;\mathrm{M}$ 字，Cache 容量为 $4\;\mathrm{K}$ 字，要求一个主存周期从主存取得一个块。采用全相联地址映像，用相联目录表实现地址变换。求相联目录表的行数、比较位数、宽度和总位数。
